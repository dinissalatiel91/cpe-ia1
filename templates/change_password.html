{% extends "base.html" %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-6">
    <div class="card shadow-sm app-card">
      <div class="card-body p-4">
        <h1 class="h5 fw-bold mb-3">Alterar palavra-passe</h1>

        <form method="post">
          {{ form.hidden_tag() }}

          <div class="mb-3">
            <label class="form-label">{{ form.current_password.label }}</label>
            {{ form.current_password(class="form-control", placeholder="Password actual") }}
          </div>

          <div class="mb-2">
            <label class="form-label">{{ form.new_password.label }}</label>
            {{ form.new_password(class="form-control", placeholder="Nova password") }}
          </div>

          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="togglePw">
            <label class="form-check-label" for="togglePw">Mostrar passwords</label>
          </div>

          {{ form.submit(class="btn btn-primary w-100") }}
        </form>

        {% if shown_new_password %}
          <hr class="my-4">
          <div class="alert alert-success">
            <div class="fw-bold">Nova palavra-passe (para a defesa):</div>
            <div class="mt-2">
              <code style="font-size: 1rem;">{{ shown_new_password }}</code>
            </div>
          </div>
        {% endif %}

      </div>
    </div>
  </div>
</div>

<script>
  const toggle = document.getElementById("togglePw");
  const inputs = document.querySelectorAll('input[type="password"]');
  if (toggle) {
    toggle.addEventListener("change", () => {
      inputs.forEach(i => i.type = toggle.checked ? "text" : "password");
    });
  }
</script>
{% endblock %}
